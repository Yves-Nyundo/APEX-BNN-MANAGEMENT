{% extends "base.html" %}
{% block title %}Edit {{ item.name }}{% endblock %}

{% block content %}
<h1 class="text-2xl font-bold mb-6">Edit Inventory Item</h1>

<!-- Flash messages -->
<div id="flashes">
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% for category, message in messages %}
      <div class="p-3 mb-4 text-sm rounded-md
        {% if category == 'success' %}bg-green-100 text-green-800
        {% elif category == 'error' %}bg-red-100 text-red-800
        {% else %}bg-blue-100 text-blue-800{% endif %}">
        {{ message }}
      </div>
    {% endfor %}
  {% endwith %}
</div>

<form method="POST" class="bg-white p-6 rounded-lg shadow-md space-y-4">
  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

  <div>
    <label class="block text-sm font-medium text-gray-700 mb-1">Name *</label>
    <input type="text"
           name="name"
           value="{{ request.form.name or item.name }}"
           class="w-full px-3 py-2 border border-gray-300 rounded-md"
           required>
  </div>

  <div>
    <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
    <textarea name="description"
              class="w-full px-3 py-2 border border-gray-300 rounded-md"
              rows="3">{{ request.form.description or item.description }}</textarea>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">Category</label>
      <input type="text"
             name="category"
             value="{{ request.form.category or item.category or '' }}"
             placeholder="e.g., Electronics"
             class="w-full px-3 py-2 border border-gray-300 rounded-md">
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">Currency</label>
      <input type="text"
             name="currency"
             value="{{ request.form.get('currency', item.currency) }}"
             class="w-full px-3 py-2 border border-gray-300 rounded-md"
             maxlength="3" required>
    </div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">Quantity on Hand</label>
      <input type="number"
             name="quantity_on_hand"
             value="{{ request.form.quantity_on_hand or item.quantity_on_hand or '' }}"
             min="0"
             class="w-full px-3 py-2 border border-gray-300 rounded-md">
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">Reorder Point</label>
      <input type="number"
             name="reorder_point"
             value="{{ request.form.reorder_point or item.reorder_point or '' }}"
             min="0"
             class="w-full px-3 py-2 border border-gray-300 rounded-md">
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">Unit Cost ($)</label>
      <input type="number"
             step="0.01"
             name="unit_cost"
             value="{{ request.form.unit_cost or item.unit_cost or '' }}"
             min="0"
             class="w-full px-3 py-2 border border-gray-300 rounded-md">
    </div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">Standard Price ($)</label>
      <input type="number"
             step="0.01"
             name="standard_price"
             value="{{ request.form.standard_price or item.standard_price or '' }}"
             min="0"
             class="w-full px-3 py-2 border border-gray-300 rounded-md">
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">COGS ($)</label>
      <input type="number"
             step="0.01"
             name="cogs"
             value="{{ request.form.cogs or item.cogs or '' }}"
             min="0"
             class="w-full px-3 py-2 border border-gray-300 rounded-md">
    </div>
  </div>

  <div class="flex items-center">
    <input type="checkbox" name="is_active" id="is_active" class="mr-2"
           {% if request.form.get('is_active') != None or item.is_active %}checked{% endif %}>
    <label for="is_active" class="text-sm text-gray-700">Is Active</label>
  </div>

  <div class="flex gap-3 pt-4">
    <button type="submit" class="bg-purple-600 text-white px-5 py-2 rounded-md hover:bg-purple-700">Update Item</button>
    <a href="{{ url_for('list_inventory') }}" class="bg-gray-300 text-gray-800 px-5 py-2 rounded-md hover:bg-gray-400">Cancel</a>
  </div>
</form>
{% endblock %}
