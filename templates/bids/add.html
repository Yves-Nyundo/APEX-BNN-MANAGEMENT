<!-- templates/bids/add.html -->
{% extends "base.html" %}
{% block title %}Add Bid{% endblock %}

{% block content %}
<h1 class="text-2xl font-bold mb-6">Submit New Bid</h1>

<form method="POST" class="space-y-6">
  {{ form.hidden_tag() }}

  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <div>
      {{ form.item_description.label(class="block font-medium mb-1") }}
      {{ form.item_description(class="w-full border rounded p-2") }}
    </div>
    <div>
      {{ form.our_bid_price.label(class="block font-medium mb-1") }}
      {{ form.our_bid_price(class="w-full border rounded p-2") }}
    </div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
    <div>
      {{ form.project_type.label(class="block font-medium mb-1") }}
      {{ form.project_type(class="w-full border rounded p-2") }}
    </div>
    <div>
      {{ form.estimated_budget.label(class="block font-medium mb-1") }}
      {{ form.estimated_budget(class="w-full border rounded p-2") }}
    </div>
    <div>
      {{ form.location.label(class="block font-medium mb-1") }}
      {{ form.location(class="w-full border rounded p-2") }}
    </div>
  </div>

  <div>
    {{ form.procurement_item_id.label(class="block font-medium mb-1") }}
    {{ form.procurement_item_id(class="w-full border rounded p-2") }}
  </div>

  <div>
    {{ form.bid_date.label(class="block font-medium mb-1") }}
    {{ form.bid_date(class="w-full border rounded p-2") }}
  </div>

  <h3 class="text-xl font-medium mt-6">Competitor Bids (Optional)</h3>
  <div id="competitor-bids">
    <div class="flex space-x-4 mb-4">
      <select name="competitor_ids[]" class="border rounded p-2 flex-1">
        <option value="">Select Competitor</option>
        {% for comp in competitors %}
        <option value="{{ comp.id }}">{{ comp.name }}</option>
        {% endfor %}
      </select>
      <input type="number" name="competitor_bid_prices[]" placeholder="Bid Price" class="border rounded p-2 w-1/3" step="0.01">
    </div>
  </div>
  <button type="button" onclick="addCompetitorField()" class="text-sm text-blue-600 hover:underline">+ Add Competitor</button>

  {{ form.submit(class="bg-teal-600 text-white px-6 py-2 rounded hover:bg-teal-700 mt-6") }}
  <a href="{{ url_for('list_bids') }}" class="text-gray-600 ml-4 hover:underline">Cancel</a>
</form>

<script>
function addCompetitorField() {
  const container = document.getElementById('competitor-bids');
  const div = document.createElement('div');
  div.className = 'flex space-x-4 mb-4';
  div.innerHTML = `
    <select name="competitor_ids[]" class="border rounded p-2 flex-1">
      <option value="">Select Competitor</option>
      {% for comp in competitors %}
      <option value="{{ comp.id }}">{{ comp.name }}</option>
      {% endfor %}
    </select>
    <input type="number" name="competitor_bid_prices[]" placeholder="Bid Price" class="border rounded p-2 w-1/3" step="0.01">
    <button type="button" onclick="this.parentElement.remove()" class="text-red-600">âœ•</button>
  `;
  container.appendChild(div);
}
</script>
{% endblock %}
